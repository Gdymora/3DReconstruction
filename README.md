# 3D-Реконструкція з 2D-зображень

Система для створення 3D-моделей з набору 2D-зображень з використанням технологій комп'ютерного зору та машинного навчання. Проект реалізований як веб-додаток з використанням Docker для простого розгортання.

## Архітектура проекту

Проект побудований на основі мікросервісної архітектури і складається з наступних компонентів:

- **Бекенд**: Python Flask API з алгоритмами 3D-реконструкції
- **Фронтенд**: React додаток з інтерфейсом користувача та 3D-переглядачем
- **Nginx**: Веб-сервер для проксіювання запитів і статичних файлів
- **Docker**: Контейнеризація для легкого розгортання

## Технології

- **Бекенд:**
  - Python 3.8+
  - Flask
  - OpenCV
  - COLMAP
  - OpenMVS
  - Open3D
  - NumPy
  - PyTorch

- **Фронтенд:**
  - React
  - Material-UI
  - Three.js
  - React Three Fiber
  - Axios

- **Інфраструктура:**
  - Docker
  - Nginx
  - Docker Compose

## Встановлення та запуск

### Передумови

- Docker і Docker Compose
- Git
- 4+ ГБ оперативної пам'яті
- GPU (опціонально, для прискорення реконструкції)

### Клонування репозиторію

```bash
git clone https://github.com/username/3d-reconstruction.git
cd 3d-reconstruction
```

### Запуск додатку

```bash
# Створення та запуск контейнерів
docker-compose up -d

# Перегляд логів
docker-compose logs -f
```

Додаток буде доступний за адресою http://localhost

### Зупинка додатку

```bash
docker-compose down
```

## Використання

1. **Завантаження зображень**
   - Завантажте 10-30 зображень об'єкта, зроблених з різних ракурсів
   - Забезпечте хороше перекриття між зображеннями
   - Підтримуються формати JPG, PNG, TIFF

2. **Налаштування реконструкції**
   - Виберіть якість реконструкції (низька, середня, висока)
   - Виберіть метод реконструкції (COLMAP, OpenMVS, нейронний)

3. **Запуск реконструкції**
   - Натисніть "Створити 3D-модель"
   - Процес може зайняти від 1 до 10 хвилин залежно від кількості зображень та обраної якості

4. **Отримання результатів**
   - Перегляд 3D-моделі в браузері
   - Завантаження моделі в різних форматах (OBJ, PLY, GLTF)

## Поради для кращих результатів

- Використовуйте зображення з хорошою якістю і роздільною здатністю
- Уникайте розмитих зображень
- Забезпечте рівномірне освітлення об'єкта
- Уникайте відблисків і прозорих/дзеркальних поверхонь
- Об'єкт повинен бути нерухомим під час фотографування
- Створюйте знімки з перекриттям не менше 60%

## Обмеження

- Система працює найкраще з об'єктами, що мають чітку текстуру
- Прозорі, дзеркальні або однотонні об'єкти можуть бути реконструйовані неправильно
- Максимальна кількість зображень обмежена (рекомендується до 100)
- Час обробки залежить від кількості та якості зображень

## Структура проекту

```
3d-reconstruction/
├── api/                    # Flask API
│   ├── app.py              # Основний файл додатку
│   └── reconstruction/     # Модулі реконструкції
├── frontend/               # React фронтенд
│   ├── public/             # Статичні файли
│   └── src/                # Вихідний код React
├── nginx/                  # Конфігурація Nginx
├── data/                   # Директорія для даних
│   ├── uploads/            # Завантажені зображення
│   └── results/            # Результати реконструкції
├── docker-compose.yml      # Конфігурація Docker Compose
└── .env                    # Змінні середовища
```
## Підсумок проекту 3D-реконструкції з 2D-зображень

Ми успішно створили повноцінну систему для 3D-реконструкції з 2D-зображень з використанням Python, Flask, React та Docker. Ось що ми реалізували:

### Компоненти системи:

1. **Бекенд на Python/Flask**:
   - API для завантаження зображень
   - Модулі для реконструкції 3D-моделей з використанням COLMAP, OpenMVS та нейронних мереж
   - Функції для обробки та оптимізації 3D-моделей

2. **Фронтенд на React**:
   - Інтерфейс користувача для завантаження зображень та налаштування параметрів реконструкції
   - 3D-переглядач на основі Three.js для інтерактивного дослідження моделей
   - Сторінки для результатів та інформації про проект

3. **Docker-контейнеризація**:
   - Повна Docker-композиція для легкого розгортання
   - Nginx для проксіювання та обслуговування статичних файлів
   - Скрипти для встановлення, запуску та зупинки системи

### Алгоритм роботи:

1. Користувач завантажує набір зображень об'єкта
2. Система аналізує зображення, знаходить спільні точки та визначає позиції камер
3. Створюється хмара точок, яка представляє 3D-структуру об'єкта
4. З хмари точок генерується полігональна 3D-модель
5. Модель оптимізується, текстурується та експортується в різних форматах
6. Користувач може переглянути модель у вбудованому 3D-переглядачі або завантажити її

### Як запустити проект:

1. Клонувати репозиторій
2. Виконати `chmod +x make-executable.sh && ./make-executable.sh` для налаштування прав
3. Встановити залежності: `sudo ./install-deps.sh`
4. Запустити систему: `./start.sh`
5. Відкрити в браузері: `http://localhost:3000`

Ця система є потужним інструментом для 3D-реконструкції, який можна використовувати для створення 3D-моделей реальних об'єктів, культурної спадщини, архітектурних елементів та багато іншого. Вона поєднує класичні методи комп'ютерного зору та сучасні підходи на основі нейронних мереж для досягнення оптимальних результатів.

Ваше питання дуже доречне! Проекти 3D-реконструкції на основі фотографій дійсно активно використовуються в різних галузях.

Подібні реалізації мають значну практичну цінність і застосовуються в наступних сферах:

1. **Збереження культурної спадщини** - музеї та організації з охорони пам'яток використовують подібні технології для створення цифрових копій артефактів, скульптур та архітектурних об'єктів. Наприклад, проект Rekrei (колишній Project Mosul) використовує фотограмметрію для відновлення культурних артефактів, знищених у конфліктних зонах.

2. **Архітектура та будівництво** - для документування існуючих споруд, створення BIM-моделей (Building Information Modeling) та планування реконструкцій. Компанії як Pix4D та Agisoft пропонують комерційні рішення для цієї галузі.

3. **Археологія** - археологи використовують подібні інструменти для документування розкопок і створення 3D-моделей артефактів.

4. **Індустрія розваг** - ігрові та кіностудії використовують фотограмметрію для створення реалістичних 3D-моделей для ігор та візуальних ефектів.

5. **Електронна комерція** - для створення 3D-представлень товарів в онлайн-магазинах.

6. **Медицина** - для 3D-моделювання анатомічних структур.

Серед популярних реалізацій:

- **Reality Capture** - комерційне ПЗ для фотограмметрії, що використовується професіоналами
- **Agisoft Metashape** - професійне ПЗ для фотограмметрії
- **Meshroom** - безкоштовне ПЗ з відкритим кодом для 3D-реконструкції
- **COLMAP** - гнучке ПЗ з відкритим кодом для SfM (Structure from Motion)
- **Sketchfab** - популярна платформа для публікації та обміну 3D-моделями, яка також пропонує інструменти для 3D-сканування за допомогою смартфонів

Особливу цінність мають саме веб-системи, подібні до нашої, оскільки вони зменшують бар'єр входу і дозволяють користувачам без спеціальних технічних знань створювати 3D-моделі. Крім того, використання Docker у нашому проекті значно полегшує розгортання на різних платформах.

Отже, наш проект не лише корисний, але й відповідає сучасним тенденціям в галузі 3D-реконструкції, пропонуючи доступне рішення з відкритим кодом, що поєднує класичні методи комп'ютерного зору та новітні підходи на основі нейронних мереж.

В нашому проекті 3D-реконструкції використовується комбінація різних технологій. Ось короткий огляд основних компонентів, окрім вже згаданих Python, Three.js, Flask і OpenCV:

### Основні технології бекенду:
1. **COLMAP** - потужний інструмент для Structure from Motion (SfM), який виконує реконструкцію сцени з набору зображень
2. **OpenMVS** - рішення для реконструкції щільної хмари точок і створення високоякісних текстурованих мешів
3. **Open3D** - бібліотека для обробки 3D-даних, включаючи обробку хмар точок і маніпуляцію мешами
4. **PyTorch** - фреймворк глибокого навчання для нейромережевого підходу до реконструкції
5. **NumPy** - для математичних обчислень і маніпуляцій масивами
6. **Trimesh** - бібліотека для роботи з трикутними мешами
7. **Gunicorn** - WSGI HTTP сервер для запуску Python додатків

### Фронтенд:
1. **React.js** - бібліотека для створення користувацького інтерфейсу
2. **Material-UI** - компоненти React для швидкої розробки інтерфейсу
3. **React Three Fiber** - React рендерер для Three.js
4. **React Dropzone** - для завантаження файлів методом перетягування
5. **Axios** - для HTTP запитів між клієнтом і сервером

### Інфраструктура:
1. **Docker** - для контейнеризації всіх компонентів
2. **Docker Compose** - для оркестрації контейнерів
3. **Nginx** - для проксіювання запитів і обслуговування статичних файлів

### Формати даних:
1. **OBJ/MTL** - для 3D-моделей з текстурами
2. **PLY** - для зберігання хмар точок
3. **GLTF/GLB** - оптимізовані формати для веб-перегляду 3D-моделей

Ця архітектура забезпечує повний конвеєр від завантаження зображень до інтерактивного перегляду готової 3D-моделі в єдиному, легко розгорнутому рішенні.

## Ліцензія

Цей проект розповсюджується під ліцензією MIT.

## Контакти

Електронна пошта: example@example.com
GitHub: https://github.com/username
https://www.open3d.org/
https://medium.com/data-science/3d-data-processing-with-open3d-c3062aadc72e
https://docs.luxonis.com/software/depthai/examples/pointcloud_visualization/
https://demuc.de/colmap/datasets/

ПДякую за запитання про COLMAP. Давайте розглянемо, що таке COLMAP і як він відрізняється від Open3D та OpenMVS.

## COLMAP

COLMAP - це потужне програмне забезпечення з відкритим кодом для реконструкції 3D-об'єктів з набору звичайних фотографій. Він спеціалізується на процесі Structure-from-Motion (SfM) та Multi-View Stereo (MVS).

**Основні можливості:**
- Повна система для фотограмметричної 3D-реконструкції
- Реалізація алгоритмів розрідженої (sparse) та щільної (dense) реконструкції
- Автоматичне зіставлення особливостей і калібрування камери
- Тріангуляція точок для створення розрідженої хмари точок
- Генерація щільної хмари точок
- Графічний інтерфейс користувача та інтерфейс командного рядка
- Висока точність та надійність алгоритмів

## Порівняння COLMAP, Open3D та OpenMVS

### Етапи в процесі фотограмметричної 3D-реконструкції

**COLMAP:**
- Зіставлення особливостей (Feature matching)
- Реконструкція та калібрування камери
- Тріангуляція точок для sparse reconstruction
- Щільна реконструкція (dense reconstruction)

**OpenMVS:**
- Зазвичай отримує initial sparse reconstruction від COLMAP
- Зосереджений на щільній реконструкції, створенні мешу та текстуруванні
- Дуже ефективний на етапах post-processing після initial sparse reconstruction

**Open3D:**
- Більш загальна бібліотека для роботи з уже створеними 3D-даними
- Менш спеціалізована для фотограмметричної реконструкції
- Зручна для обробки та візуалізації 3D-даних

### Типовий робочий процес

У професійних проектах ці інструменти часто використовуються разом:

1. **COLMAP**: для initial sparse reconstruction і калібрування камери
2. **OpenMVS**: для щільної реконструкції, створення та текстурування мешу
3. **Open3D**: для подальшої обробки, аналізу та візуалізації 3D-моделей

 api/
├── reconstruction/
│   ├── __init__.py
│   ├── reconstructor.py       # Основний клас реконструкції
│   ├── pipeline/
│   │   ├── __init__.py
│   │   ├── base_pipeline.py   # Базовий клас для всіх пайплайнів
│   │   ├── colmap_pipeline.py # Пайплайн з використанням COLMAP
│   │   ├── openmvs_pipeline.py # Пайплайн з використанням OpenMVS
│   │   └── custom_pipeline.py # Власний пайплайн реконструкції
│   ├── processing/
│   │   ├── __init__.py
│   │   ├── point_cloud.py     # Обробка хмар точок
│   │   ├── mesh.py            # Створення і обробка мешів
│   │   └── texture.py         # Робота з текстурами
│   ├── utils/
│   │   ├── __init__.py
│   │   ├── logging_utils.py   # Утиліти для логування
│   │   ├── file_utils.py      # Робота з файлами
│   │   ├── gpu_utils.py       # Перевірка GPU і CUDA
│   │   └── progress_tracker.py # Відстеження прогресу
│   └── export/
│       ├── __init__.py
│       └── model_exporter.py  # Експорт моделей у різні формати
└── app.py                     # Основний файл Flask

docker exec -it reconstruction-api cat /data/results/931851b1-29e5-4204-8d6e-b8ff64c8f4d0/metadata.json

З логів бачу, що процес реконструкції успішно прогресує:

1. Спочатку завершився етап feature extraction (виявлення ключових точок)
2. Перший етап feature matching (зіставлення ключових точок між зображеннями)
3. Прогрес оновлено до 20%: `Прогрес оновлено: sfm - 20% - Зіставлення ключових точок`
етапи після feature matching будуть:
1. Mapper (sparse reconstruction) - ~50% прогресу
2. Генерація щільної хмари точок - ~70% прогресу 
3. Створення меша - ~80% прогресу
4. Текстурування - ~90% прогресу
5. Експорт моделі - ~100% прогресу

Переконайтеся, що на фронтенді регулярно запитується статус через API, щоб відображати актуальний прогрес. Якщо ви оновили код ResultsPage.js, як ми обговорювали раніше, прогрес має оновлюватися автоматично кожні 3 секунди.